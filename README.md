; Script generated by the Inno Setup Script Wizard.
; SEE THE DOCUMENTATION FOR DETAILS ON CREATING INNO SETUP SCRIPT FILES!

[Setup]
; NOTE: The value of AppId uniquely identifies this application.
; Do not use the same AppId value in installers for other applications.
; (To generate a new GUID, click Tools | Generate GUID inside the IDE.)
AppId={{259132CD-5E5A-4E11-86A3-E7D8FBC63679}
AppName=Aoe2 Patch
AppVerName=1.01
AppPublisher=Katsuie Inc.
AppPublisherURL=http://www.gameranger.com/
AppSupportURL=http://www.gameranger.com/
AppUpdatesURL=http://www.gameranger.com/
CreateAppDir=yes
DefaultDirName=C:\Program Files (x86)\Microsoft Games\Age of Empires II
AppendDefaultDirName=no
OutputDir=C:\Users\m\Desktop\AOE2Patch\output
OutputBaseFilename=Aoe2Patch
SetupIconFile=C:\Users\m\Desktop\AOE2Patch\aok.ico
Compression=lzma
SolidCompression=yes
WizardSmallImageFile=C:\Users\m\Desktop\AOE2Patch\gr1.bmp

[Languages]
Name: "english"; MessagesFile: "compiler:Default.isl"
Name: "basque"; MessagesFile: "compiler:Languages\Basque.isl"
Name: "brazilianportuguese"; MessagesFile: "compiler:Languages\BrazilianPortuguese.isl"
Name: "catalan"; MessagesFile: "compiler:Languages\Catalan.isl"
Name: "czech"; MessagesFile: "compiler:Languages\Czech.isl"
Name: "danish"; MessagesFile: "compiler:Languages\Danish.isl"
Name: "dutch"; MessagesFile: "compiler:Languages\Dutch.isl"
Name: "finnish"; MessagesFile: "compiler:Languages\Finnish.isl"
Name: "french"; MessagesFile: "compiler:Languages\French.isl"
Name: "german"; MessagesFile: "compiler:Languages\German.isl"
Name: "hebrew"; MessagesFile: "compiler:Languages\Hebrew.isl"
Name: "hungarian"; MessagesFile: "compiler:Languages\Hungarian.isl"
Name: "italian"; MessagesFile: "compiler:Languages\Italian.isl"
Name: "norwegian"; MessagesFile: "compiler:Languages\Norwegian.isl"
Name: "polish"; MessagesFile: "compiler:Languages\Polish.isl"
Name: "portuguese"; MessagesFile: "compiler:Languages\Portuguese.isl"
Name: "russian"; MessagesFile: "compiler:Languages\Russian.isl"
Name: "slovak"; MessagesFile: "compiler:Languages\Slovak.isl"
Name: "slovenian"; MessagesFile: "compiler:Languages\Slovenian.isl"
Name: "spanish"; MessagesFile: "compiler:Languages\Spanish.isl"

[Registry]
;Root: "HKLM"; Subkey: "SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers"; ValueType: String; ValueName: "{app}\tomcat7w.exe"; ValueData: "RUNASADMIN"; Flags: uninsdeletekeyifempty uninsdeletevalue; MinVersion: 0,6.1 Root: hkCU; Subkey: SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers; ValueType: String; ValueName: {app}\empires2.exe; ValueData: RUNASADMIN WINXPSP3
Root: "HKCU"; Subkey: "SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers"; ValueType: String; ValueName: "{app}\empires2.exe"; ValueData: "RUNASADMIN WINXPSP3";
Root: "HKCU"; Subkey: "SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers"; ValueType: String; ValueName: "{app}\Age2_x1\age2_x1.exe"; ValueData: "RUNASADMIN WINXPSP3";
Root: "HKCU"; Subkey: "SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers"; ValueType: String; ValueName: "{app}\age2_x1.exe"; ValueData: "RUNASADMIN WINXPSP3";
[Tasks]
Name: Windowed_Mod; Description: Windowed Mod
;Name: vcredist_x64; Description: Install Visual C++
Name: Userpatch_WideScreen; Description: "User Patch Wide Screen like Voobly"; GroupDescription: "Wide Screen Resolution"; Flags: exclusive
Name: Centred_WideScreen; Description: "Centred Wide Screen"; GroupDescription: "Wide Screen Resolution"; Flags: exclusive unchecked
Name: Ao20_portForwarding; Description: "Aok 2.0 Port Forwarding" ;Flags:unchecked

[Files]
;Source: "C:\Users\m\Desktop\Aoe2 patch files\VC_redist.x86.exe"; DestDir: "{app}";Tasks: vcredist_x64
;Source: "C:\Users\m\Desktop\Aoe2 patch files\RebuildLanguageDll.exe"; DestDir: "{app}" ;userpatch voobly wide screen resolution
Source: "C:\Users\m\Desktop\AOE2Patch\dsound.dll"; DestDir: "{app}"; Tasks: Userpatch_WideScreen
;Centred wide screen resolution
Source: "C:\Users\m\Desktop\AOE2Patch\dsound.dll"; DestDir: "{app}\Age2_x1"; Tasks: Userpatch_WideScreen
Source: "C:\Users\m\Desktop\AOE2Patch\centred\dsound.dll"; DestDir: "{app}"; Tasks: Centred_WideScreen
Source: "C:\Users\m\Desktop\AOE2Patch\centred\dsound.dll"; DestDir: "{app}\Age2_x1"; Tasks: Centred_WideScreen

Source: "C:\Users\m\Desktop\AOE2Patch\windmode.dll";DestDir: "{app}\Age2_x1"; Tasks: Windowed_Mod
Source: "C:\Users\m\Desktop\AOE2Patch\ini\mouse\wndmode.ini"; DestDir: "{app}\Age2_x1";Tasks: Windowed_Mod
;Source: "C:\Users\m\Documents\Age of Empires II\language.dll"; DestDir: "{app}"; Flags: uninsneveruninstall
Source: "C:\Users\m\Desktop\AOE2Patch\miniupnpc.dll"; DestDir: "{app}"; Tasks: Ao20_portForwarding
Source: "C:\Users\m\Desktop\AOE2Patch\windmode.dll"; DestDir: "{app}"; Tasks: Windowed_Mod
Source: "C:\Users\m\Desktop\AOE2Patch\ini\mouse\wndmode.ini"; DestDir: "{app}"; Tasks: Windowed_Mod
Source: "C:\Users\m\Desktop\AOE2Patch\gamedata20c.drs"; DestDir: "{app}\Data"; Flags: uninsneveruninstall
Source: "C:\Users\m\Desktop\AOE2Patch\language_default.dll"; DestDir: "{app}"
Source: "C:\Users\m\Desktop\AOE2Patch\icon.drs"; DestDir: "{app}\Data"
;[Run]
;Filename: "{app}\VC_redist.x86.exe"; Description: "Launch Visual c++ installation";Tasks: vcredist_x64
;Filename: "{app}\RebuildLanguageDll.EXE"; Description: "Launch RebuildLanguageDll to rebuild langa"
;Filename: "reg.exe"; Parameters: "DELETE ""HKLM\Software\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers"" /v ""{app}\empires2.exe"" /f"
;Filename: "reg.exe"; Parameters: "Add ""HKLM\Software\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers"" /v ""{app}\empires2.exe"" /d ""WINXPSP3"
