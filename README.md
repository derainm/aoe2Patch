; Script generated by the Inno Setup Script Wizard.
; SEE THE DOCUMENTATION FOR DETAILS ON CREATING INNO SETUP SCRIPT FILES!

 
[Setup]
; NOTE: The value of AppId uniquely identifies this application.
; Do not use the same AppId value in installers for other applications.
; (To generate a new GUID, click Tools | Generate GUID inside the IDE.)
AppId={{7048AC41-56EF-4191-B020-6808CC42C04B}
AppName=Aoe2 patch
AppVersion=1.0,1.0c,2.0,2.0a,2.0b,2.0c
;AppVerName=Aoe2 patch 1.0,1.0c,2.0,2.0a,2.0b,2.0c
AppPublisher=Katsuie Inc.
AppPublisherURL=http://aokpatch.ml/
AppSupportURL=http://aokpatch.ml/
AppUpdatesURL=http://aokpatch.ml/
DefaultDirName=C:\Program Files (x86)\Microsoft Games\Age of Empires II
AppendDefaultDirName=no
DefaultGroupName=Aoe2 patch
DisableProgramGroupPage=yes
OutputBaseFilename=setup
SetupIconFile=C:\Users\m\Desktop\Aoe2 patch files\aok.ico
Compression=lzma
SolidCompression=yes
PrivilegesRequired=admin 
[Languages]
Name: "english"; MessagesFile: "compiler:Default.isl"
Name: "brazilianportuguese"; MessagesFile: "compiler:Languages\BrazilianPortuguese.isl"
Name: "catalan"; MessagesFile: "compiler:Languages\Catalan.isl"
Name: "corsican"; MessagesFile: "compiler:Languages\Corsican.isl"
Name: "czech"; MessagesFile: "compiler:Languages\Czech.isl"
Name: "danish"; MessagesFile: "compiler:Languages\Danish.isl"
Name: "dutch"; MessagesFile: "compiler:Languages\Dutch.isl"
Name: "finnish"; MessagesFile: "compiler:Languages\Finnish.isl"
Name: "french"; MessagesFile: "compiler:Languages\French.isl"
Name: "german"; MessagesFile: "compiler:Languages\German.isl"
Name: "greek"; MessagesFile: "compiler:Languages\Greek.isl"
Name: "hebrew"; MessagesFile: "compiler:Languages\Hebrew.isl"
Name: "hungarian"; MessagesFile: "compiler:Languages\Hungarian.isl"
Name: "italian"; MessagesFile: "compiler:Languages\Italian.isl"
Name: "japanese"; MessagesFile: "compiler:Languages\Japanese.isl"
Name: "norwegian"; MessagesFile: "compiler:Languages\Norwegian.isl"
Name: "polish"; MessagesFile: "compiler:Languages\Polish.isl"
Name: "portuguese"; MessagesFile: "compiler:Languages\Portuguese.isl"
Name: "russian"; MessagesFile: "compiler:Languages\Russian.isl"
Name: "scottishgaelic"; MessagesFile: "compiler:Languages\ScottishGaelic.isl"
Name: "serbiancyrillic"; MessagesFile: "compiler:Languages\SerbianCyrillic.isl"
Name: "serbianlatin"; MessagesFile: "compiler:Languages\SerbianLatin.isl"
Name: "slovenian"; MessagesFile: "compiler:Languages\Slovenian.isl"
Name: "spanish"; MessagesFile: "compiler:Languages\Spanish.isl"
Name: "turkish"; MessagesFile: "compiler:Languages\Turkish.isl"
Name: "ukrainian"; MessagesFile: "compiler:Languages\Ukrainian.isl"

 [Registry]
;Root: "HKLM"; Subkey: "SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers";  ValueType: String; ValueName: "{app}\tomcat7w.exe"; ValueData: "RUNASADMIN";  Flags: uninsdeletekeyifempty uninsdeletevalue; MinVersion: 0,6.1
Root: hkCU; Subkey: SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers;  ValueType: String; ValueName: {app}\empires2.exe; ValueData: RUNASADMIN WINXPSP3  
;Root: "HKLM"; Subkey: "SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers";  ValueType: String; ValueName: "{app}\empires2.exe"; ValueData: "WINXPSP3";    
[Tasks]
Name: Windowed_Mod; Description: Windowed Mod
Name: vcredist_x64; Description: Install Visual C++
Name: Userpatch_WideScreen; Description: "User Patch Wide Screen like Voobly"; GroupDescription: "Wide Screen Resolution"; Flags: exclusive
Name: Centred_WideScreen; Description: "Centred Wide Screen"; GroupDescription: "Wide Screen Resolution"; Flags: exclusive unchecked
Name: Ao20_portForwarding; Description: "Aok 2.0 Port Forwarding"  ;Flags:unchecked
[Files]
Source: "C:\Users\m\Desktop\Aoe2 patch files\VC_redist.x86.exe"; DestDir: "{app}";Tasks: vcredist_x64
;Source: "C:\Users\m\Desktop\Aoe2 patch files\RebuildLanguageDll.exe"; DestDir: "{app}"
;userpatch voobly wide screen resolution
Source: "C:\Users\m\Desktop\Aoe2 patch files\dsound.dll"; DestDir: "{app}"; Tasks: Userpatch_WideScreen
Source: "C:\Users\m\Desktop\Aoe2 patch files\dsound.dll"; DestDir: "{app}\Age2_x1"; Tasks: Userpatch_WideScreen
;Centred wide screen resolution
Source: "C:\Users\m\Desktop\Aoe2 patch files\centred\dsound.dll"; DestDir: "{app}"; Tasks: Centred_WideScreen
Source: "C:\Users\m\Desktop\Aoe2 patch files\centred\dsound.dll"; DestDir: "{app}\Age2_x1"; Tasks: Centred_WideScreen


Source: "C:\Users\m\Desktop\Aoe2 patch files\windmode.dll"; DestDir: "{app}\Age2_x1"; Tasks: Windowed_Mod
Source: "C:\Users\m\Desktop\Aoe2 patch files\wndmode.ini"; DestDir: "{app}\Age2_x1"; Tasks: Windowed_Mod
;Source: "C:\Users\m\Documents\Age of Empires II\language.dll"; DestDir: "{app}"; Flags:  uninsneveruninstall
Source: "C:\Users\m\Desktop\Aoe2 patch files\miniupnpc.dll"; DestDir: "{app}"; Tasks: Ao20_portForwarding
Source: "C:\Users\m\Desktop\Aoe2 patch files\windmode.dll"; DestDir: "{app}";  Tasks: Windowed_Mod
Source: "C:\Users\m\Desktop\Aoe2 patch files\wndmode.ini"; DestDir: "{app}";  Tasks: Windowed_Mod
Source: "C:\Users\m\Desktop\Aoe2 patch files\data\gamedata20c.drs"; DestDir: "{app}\Data"; Flags: uninsneveruninstall 


[Run]
Filename: "{app}\VC_redist.x86.exe";  Description: "Launch Visual c++ installation";Tasks: vcredist_x64
;Filename: "{app}\RebuildLanguageDll.EXE"; Description: "Launch RebuildLanguageDll to rebuild langa"
;Filename: "reg.exe"; Parameters: "DELETE ""HKLM\Software\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers"" /v ""{app}\empires2.exe"" /f"
;Filename: "reg.exe"; Parameters: "Add ""HKLM\Software\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers"" /v ""{app}\empires2.exe"" /d ""WINXPSP3"

